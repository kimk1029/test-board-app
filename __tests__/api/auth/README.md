# 인증 API 테스트

회원가입과 로그인 API에 대한 테스트 케이스입니다.

## 테스트 실행

```bash
# 모든 인증 테스트 실행
npm run test:auth

# 특정 테스트 파일 실행
npm test -- __tests__/api/auth/register.test.ts
npm test -- __tests__/api/auth/login.test.ts
```

## 테스트 케이스

### 회원가입 API (`register.test.ts`)

1. **성공적인 회원가입**
   - 이메일, 비밀번호, 닉네임이 모두 제공된 경우
   - 이메일 인증이 완료된 경우
   - 사용자 생성 및 인증 코드 삭제 확인

2. **필수 필드 검증**
   - 이메일 누락 시 400 에러
   - 비밀번호 누락 시 400 에러
   - 닉네임 누락 시 400 에러
   - 빈 닉네임 시 400 에러

3. **이메일 중복 확인**
   - 이미 존재하는 이메일로 가입 시도 시 400 에러

4. **이메일 인증 확인**
   - 이메일 인증이 완료되지 않은 경우 400 에러

5. **서버 오류 처리**
   - 데이터베이스 오류 시 500 에러

### 로그인 API (`login.test.ts`)

1. **성공적인 로그인**
   - 보너스 없음: 오늘 이미 로그인한 경우
   - 보너스 지급: 하루에 한 번 로그인 보너스(10 포인트) 지급

2. **필수 필드 검증**
   - 이메일 누락 시 400 에러
   - 비밀번호 누락 시 400 에러

3. **인증 실패**
   - 존재하지 않는 사용자 시 401 에러
   - 잘못된 비밀번호 시 401 에러
   - 구글 로그인 사용자(비밀번호 없음) 시 401 에러

4. **서버 오류 처리**
   - 데이터베이스 오류 시 500 에러

## 모킹

테스트는 다음을 모킹합니다:
- Prisma Client (`@/lib/prisma`)
- Auth 함수 (`@/lib/auth`: `hashPassword`, `comparePassword`, `generateToken`)
- Points 함수 (`@/lib/points`: `calculateLevel`)

## 테스트 구조

각 테스트는 다음을 검증합니다:
- HTTP 상태 코드
- 응답 메시지/에러
- Prisma 함수 호출 여부 및 인자
- Auth 함수 호출 여부 및 인자
- 로그인 보너스 지급 여부
