# 블랙잭 게임 룰 점검 보고서

## ✅ 올바르게 구현된 룰

### 1. 기본 게임 플로우
- ✅ 초기 카드 분배: 플레이어 2장, 딜러 2장 (딜러 두 번째 카드는 숨김)
- ✅ 플레이어 턴: Hit, Stand, Double Down 가능
- ✅ 딜러 턴: 플레이어 턴 종료 후 자동 진행

### 2. 점수 계산
- ✅ A는 1 또는 11로 계산 (21 초과 시 자동으로 1로 변경)
- ✅ J, Q, K는 10으로 계산
- ✅ 블랙잭 체크: 초기 2장, 합 21

### 3. 딜러 규칙
- ✅ 딜러는 하드 17 이상이면 스탠드
- ✅ 딜러는 16 이하면 히트
- ✅ **수정 완료**: 소프트 17(A+6)도 히트하도록 수정됨

### 4. 배당률
- ✅ 블랙잭 승리: 2.5배 (원금 포함, 순수익 1.5배)
- ✅ 일반 승리: 2배 (원금 포함, 순수익 1배)
- ✅ 무승부: 원금 반환 (1배)
- ✅ 패배: 0배

### 5. 버스트 처리
- ✅ 플레이어 버스트: 즉시 패배
- ✅ 딜러 버스트: 플레이어 승리

### 6. 더블다운
- ✅ 추가 베팅 금액 차감
- ✅ 카드 1장만 받고 자동 스탠드
- ✅ **수정 완료**: 첫 2장만 가능하도록 검증 추가됨

### 7. 게임 결과 우선순위
- ✅ 플레이어 버스트 → 패배
- ✅ 딜러 버스트 → 승리
- ✅ 블랙잭 vs 블랙잭 → 무승부
- ✅ 플레이어 블랙잭 → 블랙잭 승리 (2.5배)
- ✅ 딜러 블랙잭 → 패배
- ✅ 점수 비교 → 높은 쪽 승리

## ⚠️ 미구현 기능

### 1. 스플릿
**현재 상태**: "준비중" 메시지만 표시
**표준 룰**: 같은 값의 카드 2장일 때 스플릿 가능
**위치**: `app/game/blackjack/BlackjackGame.ts:1137`
**우선순위**: 낮음 (선택적 기능)

### 2. 인슈어런스 서버 검증
**현재 상태**: 클라이언트에서만 처리, 서버 검증 없음
**표준 룰**: 딜러의 업카드가 A일 때 인슈어런스 가능 (베팅의 50%)
**위치**: 클라이언트만 처리
**우선순위**: 중간 (보안 강화 필요)

## ✅ 수정 완료 사항

### 1. 소프트 17 처리 ✅
- **수정 전**: 딜러가 소프트 17(A+6)일 때 스탠드
- **수정 후**: 딜러가 소프트 17일 때도 히트하도록 수정
- **위치**: `lib/game-servers/blackjack-server.ts`

### 2. 더블다운 제한 검증 ✅
- **수정 전**: 첫 2장인지 검증 없음
- **수정 후**: 첫 2장에서만 더블다운 가능하도록 검증 추가
- **위치**: `app/api/game/blackjack/route.ts` (double 액션)

## 📋 룰 검증 체크리스트

- [x] 초기 카드 분배 (플레이어 2장, 딜러 2장)
- [x] 딜러 두 번째 카드 숨김 처리
- [x] A 점수 계산 (1 또는 11)
- [x] 블랙잭 체크 (초기 2장, 합 21)
- [x] 딜러 규칙 (17 이상 스탠드, 소프트 17 히트)
- [x] 버스트 처리 (21 초과 즉시 패배)
- [x] 블랙잭 배당 (2.5배)
- [x] 일반 승리 배당 (2배)
- [x] 무승부 처리 (원금 반환)
- [x] 더블다운 제한 (첫 2장만)
- [x] 더블다운 후 자동 스탠드
- [ ] 스플릿 기능 (미구현)
- [ ] 인슈어런스 서버 검증 (클라이언트만 처리)

## 🎯 결론

블랙잭의 핵심 룰은 대부분 올바르게 구현되어 있습니다. 소프트 17 처리와 더블다운 제한 검증이 추가되어 표준 카지노 룰에 더 가까워졌습니다. 스플릿과 인슈어런스 서버 검증은 선택적 개선 사항입니다.

